---

## Sistema de contenidors: phpMyAdmin + MySQL amb `docker compose` (1/4)

**Objectiu:** aixecar un sistema format per **MySQL** (base de dades) i **phpMyAdmin** (administraci√≥ web) fent servir `docker compose`.

1) Crea una carpeta de treball i entra-hi:
```
mkdir -p ~/projectes/docker-lamp && cd ~/projectes/docker-lamp
```

2) Crea un fitxer **`docker-compose.yml`** amb aquest contingut:
```yaml
version: "3.8"
services:
  db:
    image: mysql:8.0
    container_name: db-mysql
    environment:
      - MYSQL_ROOT_PASSWORD=alumne
      - MYSQL_DATABASE=botiga
      - MYSQL_USER=app
      - MYSQL_PASSWORD=app123
    ports:
      - "3306:3306"         # (opcional) exposa MySQL al host
    volumes:
      - db_data:/var/lib/mysql

  phpmyadmin:
    image: phpmyadmin:latest
    container_name: phpmyadmin
    depends_on:
      - db
    environment:
      - PMA_HOST=db
      - PMA_USER=root
      - PMA_PASSWORD=alumne
    ports:
      - "8081:80"           # acc√©s web a phpMyAdmin

volumes:
  db_data:
```

> üîê **Notes:**  
> - Contrasenya de `root`: **alumne** (canvieu-la si cal).  
> - El volum `db_data` **persisteix** les dades de MySQL.  
> - El port `3306` √©s **opcional**; no cal exposar-lo si nom√©s fareu servir phpMyAdmin.

----

## Sistema de contenidors: phpMyAdmin + MySQL amb `docker compose` (2/4)

**Engegar el sistema**

1) Al directori on hi ha el `docker-compose.yml`, executeu:
```
docker compose up -d
```

2) Comproveu l'estat:
```
docker compose ps
```

3) Vegeu els logs (si cal diagnosticar):
```
docker compose logs -f
```

----

## Sistema de contenidors: phpMyAdmin + MySQL amb `docker compose` (3/4)

**Comprovaci√≥ via navegador**

- Obriu el navegador del vostre equip i escriviu:  
```
http://192.168.56.<XXX>:8081
```
(on **`<XXX>`** √©s la ip de la vostra m√†quina virtual)

- Pantalla d'inici de **phpMyAdmin**:  
  - **Usuari:** `root`  
  - **Contrasenya:** `alumne`

- Verificacions r√†pides dins phpMyAdmin:
  - Comproveu que existeix la BD inicial **`botiga`**.  
  - Creeu una taula de prova i inseriu-ne un parell de registres.

> üí° **Alternativa:** si heu exposat el port `3306`, podeu connectar-vos a MySQL des del host amb un client (DBeaver, MySQL Workbench, etc.) a `192.168.56.<XXX>:3306`.

----

## Sistema de contenidors: phpMyAdmin + MySQL amb `docker compose` (4/4)

**Gesti√≥ i aturada**

- Llistar serveis en marxa:
```
docker compose ps
```

- Aturar i eliminar contenidors (les dades PERSISTEIXEN al volum):
```
docker compose down
```

- Aturar i **eliminar tamb√© les dades** (‚ö†Ô∏è esborra el volum `db_data`):
```
docker compose down -v
```

- Netejar recursos que sobren (imatges o volums dangling):
```
docker system prune
```

**Entrega (opcional):**
```
tar czf exemple2_phpmyadmin_mysql.tar.gz ~/projectes/docker-lamp
```
Adjunteu el fitxer al Classroom.

---
