<!DOCTYPE html>
<html lang="ca">
<head>
  <meta charset="UTF-8" />
  <title>RA2 ‚Äì Activitats Xarxes locals</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
      color-scheme: light;
    }

    body {
      margin: 0;
      padding: 0;
      background: #f5f5f7;
      color: #222;
    }

    main {
      max-width: 1100px;
      margin: 0 auto;
      padding: 1.5rem 1rem 3rem 1rem;
    }

    h1, h2, h3 {
      font-weight: 600;
      color: #111827;
    }

    h1 {
      text-align: center;
      margin-bottom: 1.5rem;
    }

    h2 {
      margin-top: 2rem;
      border-bottom: 2px solid #e5e7eb;
      padding-bottom: 0.25rem;
    }

    h3 {
      margin-top: 1rem;
    }

    section {
      margin-top: 1rem;
      padding: 1rem 1.25rem;
      background: #ffffff;
      border-radius: 0.75rem;
      box-shadow: 0 1px 3px rgba(15, 23, 42, 0.06);
    }

    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      gap: 1rem;
      margin-bottom: 0.5rem;
    }

    .section-tag {
      font-size: 0.8rem;
      color: #6b7280;
      background: #eef2ff;
      padding: 0.1rem 0.4rem;
      border-radius: 999px;
      white-space: nowrap;
    }

    .question {
      margin-top: 1rem;
      padding-top: 0.75rem;
      border-top: 1px dashed #e5e7eb;
    }

    .question:first-of-type {
      border-top: none;
      padding-top: 0;
    }

    .question-label {
      font-weight: 500;
      margin-bottom: 0.25rem;
    }

    .question small {
      display: block;
      font-size: 0.8rem;
      color: #6b7280;
      margin-top: 0.1rem;
    }

    textarea,
    input[type="text"],
    select {
      width: 100%;
      box-sizing: border-box;
      font: inherit;
      padding: 0.45rem 0.5rem;
      border-radius: 0.5rem;
      border: 1px solid #d1d5db;
      background: #f9fafb;
      margin-top: 0.25rem;
      resize: vertical;
      min-height: 2.4rem;
    }

    textarea {
      min-height: 4rem;
    }

    textarea:focus,
    input[type="text"]:focus,
    select:focus {
      outline: none;
      border-color: #6366f1;
      box-shadow: 0 0 0 1px #6366f1;
      background: #ffffff;
    }

    label span.required {
      color: #dc2626;
      margin-left: 0.15rem;
    }

    .paste-area {
      margin-top: 0.4rem;
      border-radius: 0.75rem;
      border: 1px dashed #9ca3af;
      padding: 0.75rem;
      background: #f9fafb;
      min-height: 120px;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      font-size: 0.85rem;
      color: #6b7280;
      cursor: pointer;
    }

    .paste-area img {
      max-width: 100%;
      max-height: 260px;
      object-fit: contain;
      border-radius: 0.5rem;
    }

    .paste-area.has-image {
      justify-content: flex-start;
      text-align: left;
      padding: 0.5rem;
    }

    .info-note {
      font-size: 0.85rem;
      color: #4b5563;
      background: #eff6ff;
      border-left: 4px solid #60a5fa;
      padding: 0.4rem 0.6rem;
      border-radius: 0.4rem;
      margin-top: 0.5rem;
    }

    /* Barra de progr√©s */
    .progress-container {
      position: sticky;
      top: 0;
      background: #f5f5f7cc;
      backdrop-filter: blur(8px);
      padding: 0.5rem 0.5rem 0.75rem 0.5rem;
      z-index: 20;
      border-bottom: 1px solid #e5e7eb;
      margin: 0 -1rem 1rem -1rem;
    }

    .progress-bar-outer {
      position: relative;
      width: 100%;
      height: 0.8rem;
      border-radius: 999px;
      background: #e5e7eb;
      overflow: hidden;
    }

    .progress-bar-inner {
      height: 100%;
      width: 0%;
      border-radius: 999px;
      background: linear-gradient(90deg, #a5b4fc, #38bdf8);
      transition: width 0.25s ease-out;
    }

    .progress-text {
      margin-top: 0.25rem;
      font-size: 0.8rem;
      color: #4b5563;
      text-align: right;
    }

    .btn-row {
      margin-top: 1.5rem;
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
      justify-content: flex-end;
      align-items: center;
    }

    button {
      border-radius: 999px;
      border: none;
      padding: 0.5rem 1rem;
      font: inherit;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
    }

    .btn-primary {
      background: #4f46e5;
      color: white;
    }

    .btn-primary:hover {
      background: #4338ca;
    }

    .btn-secondary {
      background: #e5e7eb;
      color: #111827;
    }

    .btn-secondary:hover {
      background: #d1d5db;
    }

    .status-message {
      font-size: 0.85rem;
      color: #b91c1c;
    }

    .status-message.ok {
      color: #166534;
    }

    @media (max-width: 700px) {
      section {
        padding: 0.75rem 0.8rem;
      }
      .section-header {
        flex-direction: column;
        align-items: flex-start;
      }
    }
  </style>
</head>
<body>
  <main>
    <h1>RA2 ‚Äì Activitats de Xarxes locals</h1>

    <div class="progress-container">
      <div class="progress-bar-outer">
        <div id="progress-bar" class="progress-bar-inner"></div>
      </div>
      <div id="progress-text" class="progress-text">
        Progr√©s: 0% (0 de 0 camps omplerts)
      </div>
    </div>

    <!-- APARTAT 0: Dades alumne -->
    <section id="dades-alumne">
      <div class="section-header">
        <h2>0. Dades de l'alumne</h2>
        <span class="section-tag">Meta + identificaci√≥</span>
      </div>
      <p class="info-note">
        El selector d'alumne es carrega del fitxer <code>dades_alumnes.json</code>.
        Revisa que el teu nom apareix correctament i assegura't de triar el teu.
      </p>

      <div class="question">
        <label class="question-label" for="alumne-select">
          Alumne<span class="required">*</span>
        </label>
        <select id="alumne-select" data-required="true">
          <option value="">‚Äî Tria el teu nom ‚Äî</option>
        </select>
        <small>
          Si no hi apareixes, avisa el professor.
        </small>
      </div>

      <div class="question">
        <label class="question-label" for="alumne-email">
          Correu electr√≤nic (centre)
        </label>
        <input type="text" id="alumne-email" readonly
               placeholder="Es carregar√† autom√†ticament en triar l'alumne" />
      </div>

      <div class="question">
        <label class="question-label" for="alumne-grup">
          Grup / classe<span class="required">*</span>
        </label>
        <input type="text" id="alumne-grup" data-required="true"
               placeholder="Exemples: 1SMX-A, 1SMX-B‚Ä¶" value="1SMX-A"/>
      </div>
    </section>

    <!-- APARTAT 1: Cablejat (A6) -->
    <section id="cablejat">
      <div class="section-header">
        <h2>1. Cablejat (Activitat 6)</h2>
        <span class="section-tag">Tipus de cables, STP/UTP, 10BASE-X‚Ä¶</span>
      </div>

      <div class="question">
        <label class="question-label" for="cablejat-q1">
          1. Tipus de cable (Ethernet, telef√≤nic, coaxial, fibra √≤ptica)
          <span class="required">*</span>
        </label>
        <textarea id="cablejat-q1" data-section="cablejat" data-question="q1_tipus_cables" data-required="true"
          placeholder="Fes una taula textual. Exemple:
- Ethernet: velocitat m√†xima, √∫s principal, observacions
- Telef√≤nic: ...
- Coaxial: ...
- Fibra √≤ptica: ..."></textarea>
        <small>
          Indica per a cada cable: velocitat m√†xima aproximada, √∫s principal i alguna observaci√≥.
        </small>
      </div>

      <div class="question">
        <label class="question-label" for="cablejat-q2">
          2. Categories de cable Ethernet (Cat5e, Cat6, Cat6a, Cat7, Cat8‚Ä¶)
          <span class="required">*</span>
        </label>
        <textarea id="cablejat-q2" data-section="cablejat" data-question="q2_categories_ethernet" data-required="true"
          placeholder="Organitza-ho com una taula: Categoria, velocitat m√†xima, freq√º√®ncia, dist√†ncia m√†xima recomanada."></textarea>
      </div>

      <div class="question">
        <label class="question-label" for="cablejat-q3">
          3. Velocitat m√†xima d'un cable Ethernet
          <span class="required">*</span>
        </label>
        <input type="text" id="cablejat-q3" data-section="cablejat" data-question="q3_velocitat_max" data-required="true"
               placeholder="Exemples: 10 Gbps, 40 Gbps, 100 Gbps‚Ä¶" />
      </div>

      <div class="question">
        <label class="question-label" for="cablejat-q4">
          4. Difer√®ncia entre STP i UTP
          <span class="required">*</span>
        </label>
        <textarea id="cablejat-q4" data-section="cablejat" data-question="q4_stp_vs_utp" data-required="true"
          placeholder="Explica qu√® vol dir cada sigla, com estan constru√Øts els cables i en quins casos es recomana STP o UTP."></textarea>
      </div>

      <div class="question">
        <label class="question-label" for="cablejat-q5">
          5. Atenuaci√≥ i imped√†ncia
          <span class="required">*</span>
        </label>
        <textarea id="cablejat-q5" data-section="cablejat" data-question="q5_atenuacio_impedancia" data-required="true"
          placeholder="Defineix:
- Atenuaci√≥
- Imped√†ncia
i comenta per qu√® s√≥n importants en el cablejat de xarxa."></textarea>
      </div>

      <div class="question">
        <label class="question-label" for="cablejat-q6">
          6. Fam√≠lia 10BASE-X
          <span class="required">*</span>
        </label>
        <textarea id="cablejat-q6" data-section="cablejat" data-question="q6_familia_10base" data-required="true"
          placeholder="Descriu 10BASE-T, 10BASE-5 i 10BASE-2: medi (UTP/coaxial...), topologia t√≠pica, i significat de 10, BASE i T/5/2."></textarea>
      </div>

      <div class="question">
        <label class="question-label" for="cablejat-q7">
          7. Dades per cables el√®ctrics
          <span class="required">*</span>
        </label>
        <textarea id="cablejat-q7" data-section="cablejat" data-question="q7_dades_per_cable_electric" data-required="true"
          placeholder="Explica si es poden fer servir els cables el√®ctrics per enviar dades i com (tecnologies PLC, etc.)."></textarea>
      </div>

      <div class="question">
        <label class="question-label" for="cablejat-q8">
          8. Backbone o troncal de la xarxa
          <span class="required">*</span>
        </label>
        <textarea id="cablejat-q8" data-section="cablejat" data-question="q8_backbone" data-required="true"
          placeholder="Explica qu√® √©s el backbone i posa un exemple d'on el trobar√≠em dins d'un edifici o campus."></textarea>
      </div>

      <div class="question">
        <label class="question-label" for="cablejat-q9">
          9. Connectors de xarxa
          <span class="required">*</span>
        </label>
        <textarea id="cablejat-q9" data-section="cablejat" data-question="q9_connectors_text" data-required="true"
          placeholder="Descriu com a m√≠nim 3 connectors (per exemple RJ45, RJ11, BNC, LC, SC...). Per a cada un: nom, tipus de cable i √∫s principal."></textarea>

        <div class="info-note">
          A continuaci√≥, enganxa imatges dels connectors (fetes amb una eina de captura, des del portapapers).
        </div>
        <div class="paste-area"
             data-section="cablejat"
             data-question="q9_connectors_imatges"
             data-required="true">
          Clica aqu√≠ i fes <strong>Ctrl+V</strong> (o ‚åò+V) per enganxar una o diverses imatges dels connectors.
        </div>
      </div>

      <div class="question">
        <label class="question-label" for="cablejat-q10">
          10. Coaxial, topologia i terminador
          <span class="required">*</span>
        </label>
        <textarea id="cablejat-q10" data-section="cablejat" data-question="q10_coaxial_topologia_terminador" data-required="true"
          placeholder="Indica en quina topologia s'utilitzava sovint el cable coaxial i qu√® √©s un terminador."></textarea>
      </div>

      <div class="question">
        <label class="question-label" for="cablejat-q11">
          11. Difer√®ncia entre Mbps i MBps
          <span class="required">*</span>
        </label>
        <textarea id="cablejat-q11" data-section="cablejat" data-question="q11_mbps_vs_MBps" data-required="true"
          placeholder="Explica la difer√®ncia entre megabits per segon (Mb/s) i megabytes per segon (MB/s), i com fer la conversi√≥."></textarea>
      </div>

      <div class="question">
        <label class="question-label" for="cablejat-q12">
          12. Ample de banda vs velocitat
          <span class="required">*</span>
        </label>
        <textarea id="cablejat-q12" data-section="cablejat" data-question="q12_ample_vs_velocitat" data-required="true"
          placeholder="Explica la difer√®ncia entre ample de banda i velocitat de connexi√≥, amb algun exemple."></textarea>
      </div>

      <div class="question">
        <label class="question-label" for="cablejat-q13">
          13. Colors en els parells trenats
          <span class="required">*</span>
        </label>
        <textarea id="cablejat-q13" data-section="cablejat" data-question="q13_colors_parells" data-required="true"
          placeholder="Explica per qu√® es fan servir colors diferents als fils, i qu√® significa cada parell en un cable Ethernet est√†ndard."></textarea>

        <div class="info-note">
          Enganxa un esquema (captura) amb els colors d'un cable Ethernet.
        </div>
        <div class="paste-area"
             data-section="cablejat"
             data-question="q13_colors_diagrama"
             data-required="true">
          Clica i fes <strong>Ctrl+V</strong> per enganxar l'esquema de colors.
        </div>
      </div>

      <div class="question">
        <label class="question-label" for="cablejat-q14">
          14. HUB vs Switch
          <span class="required">*</span>
        </label>
        <textarea id="cablejat-q14" data-section="cablejat" data-question="q14_hub_vs_switch" data-required="true"
          placeholder="Explica com funcionen un HUB i un Switch i quines difer√®ncies tenen (tr√†nsit, col¬∑lisions, seguretat, etc.)."></textarea>
      </div>

      <div class="question">
        <label class="question-label" for="cablejat-q15">
          15. Dispositius de xarxa vs hosts
          <span class="required">*</span>
        </label>
        <textarea id="cablejat-q15" data-section="cablejat" data-question="q15_dispositius_vs_hosts" data-required="true"
          placeholder="Defineix 'dispositius de xarxa' i 'hosts' i d√≥na com a m√≠nim dos exemples de cada categoria."></textarea>
      </div>

      <div class="question">
        <label class="question-label" for="cablejat-q16">
          16. Cables directes i creuats
          <span class="required">*</span>
        </label>
        <textarea id="cablejat-q16" data-section="cablejat" data-question="q16_cables_directes_creuats" data-required="true"
          placeholder="Explica en quins casos es fan servir cables directes i en quins cables creuats."></textarea>

        <div class="info-note">
          Enganxa un esquema amb la combinaci√≥ de colors d'un cable directe i un de creuat.
        </div>
        <div class="paste-area"
             data-section="cablejat"
             data-question="q16_cables_diagrama"
             data-required="true">
          Clica i fes <strong>Ctrl+V</strong> per enganxar l'esquema de cable directe/creuat.
        </div>
      </div>
    </section>

    <!-- APARTAT 2: Fibra √≤ptica (A7) -->
    <section id="fibra">
      <div class="section-header">
        <h2>2. Fibra √≤ptica (Activitat 7)</h2>
        <span class="section-tag">Materials, avantatges, cables submarins‚Ä¶</span>
      </div>

      <div class="question">
        <label class="question-label" for="fibra-q1">
          1. Hist√≤ria i materials de la fibra √≤ptica
          <span class="required">*</span>
        </label>
        <textarea id="fibra-q1" data-section="fibra" data-question="q1_historia_materials" data-required="true"
          placeholder="Indica quan es va crear per primer cop un cable de fibra √≤ptica, de qu√® estan fets i qu√® passaria sense revestiment de protecci√≥."></textarea>
      </div>

      <div class="question">
        <label class="question-label" for="fibra-q2">
          2. Avantatges de la fibra √≤ptica
          <span class="required">*</span>
        </label>
        <textarea id="fibra-q2" data-section="fibra" data-question="q2_avantatges" data-required="true"
          placeholder="Llista els principals avantatges (amplada de banda, dist√†ncia, seguretat, immunitat a interfer√®ncies...)."></textarea>
      </div>

      <div class="question">
        <label class="question-label" for="fibra-q3">
          3. Inconvenients de la fibra √≤ptica
          <span class="required">*</span>
        </label>
        <textarea id="fibra-q3" data-section="fibra" data-question="q3_inconvenients" data-required="true"
          placeholder="Llista inconvenients (cost, fragilitat, instal¬∑laci√≥, equipament...)."></textarea>
      </div>

      <div class="question">
        <label class="question-label" for="fibra-q4">
          4. Implantaci√≥ de la fibra a Espanya
          <span class="required">*</span>
        </label>
        <textarea id="fibra-q4" data-section="fibra" data-question="q4_implantacio_espanya" data-required="true"
          placeholder="Explica quins factors han frenat que hi hagi fibra a totes les ciutats i pobles (cost, orografia, densitat de poblaci√≥, etc.)."></textarea>
      </div>

      <div class="question">
        <label class="question-label" for="fibra-q5">
          5. Velocitat m√†xima amb fibra √≤ptica
          <span class="required">*</span>
        </label>
        <input type="text" id="fibra-q5" data-section="fibra" data-question="q5_velocitat_max" data-required="true"
               placeholder="Indica una velocitat m√†xima aproximada segons les tecnologies actuals (Gbps / Tbps)." />
      </div>

      <div class="question">
        <label class="question-label" for="fibra-q6">
          6. Cables submarins
          <span class="required">*</span>
        </label>
        <textarea id="fibra-q6" data-section="fibra" data-question="q6_cables_submarins" data-required="true"
          placeholder="Defineix qu√® √©s un cable submar√≠ i descriu almenys dues rutes importants (per exemple Europa-Am√®rica...)."></textarea>

        <div class="info-note">
          Pots enganxar una imatge d'un mapa de cables submarins (opcional).
        </div>
        <div class="paste-area"
             data-section="fibra"
             data-question="q6_cables_submarins_imatge"
             data-required="false">
          Opcional: clica i fes <strong>Ctrl+V</strong> per enganxar un mapa de cables submarins.
        </div>
      </div>

      <div class="question">
        <label class="question-label" for="fibra-q7">
          7. Cable TAT-1 i percentatge de comunicacions
          <span class="required">*</span>
        </label>
        <textarea id="fibra-q7" data-section="fibra" data-question="q7_tat1_percentatge" data-required="true"
          placeholder="Explica per a qu√® servia el TAT-1 i quin percentatge aproximat de les comunicacions mundials passen per cables submarins."></textarea>
      </div>

      <div class="question">
        <label class="question-label" for="fibra-q8">
          8. Primera l√≠nia submarina amb fibra √≤ptica
          <span class="required">*</span>
        </label>
        <input type="text" id="fibra-q8" data-section="fibra" data-question="q8_primera_linia_nom" data-required="true"
               placeholder="Nom de la primera l√≠nia submarina amb fibra √≤ptica." />
      </div>

      <div class="question">
        <label class="question-label" for="fibra-q9">
          9. Not√≠cia (incident amb vaixell i xarxa submarina)
          <span class="required">*</span>
        </label>
        <textarea id="fibra-q9" data-section="fibra" data-question="q9_noticia_vaixell" data-required="true"
          placeholder="Indica en quin pa√≠s va passar l'incident, quina empresa era propiet√†ria de la xarxa i qu√® √©s ARCOS."></textarea>
      </div>

      <div class="question">
        <label class="question-label" for="fibra-q10">
          10. Taula comparativa de costos
          <span class="required">*</span>
        </label>
        <textarea id="fibra-q10" data-section="fibra" data-question="q10_taula_costos" data-required="true"
          placeholder="Compara el preu i la velocitat d'1 metre de fibra √≤ptica, cable Ethernet i cable coaxial. Ex.: 
- Fibra: preu ‚Ç¨/m, velocitat m√†x, comentaris...
- Ethernet: ...
- Coaxial: ..."></textarea>
      </div>
    </section>

    <!-- APARTAT 3: Sistemes sense fils i m√≤bils (A8) -->
    <section id="sense-fils">
      <div class="section-header">
        <h2>3. Sistemes sense fils i m√≤bils (Activitat 8)</h2>
        <span class="section-tag">FM/AM, infrarojos, salut, GPS, Galileo, 5G‚Ä¶</span>
      </div>

      <div class="question">
        <label class="question-label" for="sensefils-q1">
          1. Origen de les ones de r√†dio
          <span class="required">*</span>
        </label>
        <textarea id="sensefils-q1" data-section="sense_fils" data-question="q1_origen_radios" data-required="true"
          placeholder="Des de quan s'utilitzen les ones de r√†dio per transmetre informaci√≥ i qui en van ser els inventors principals."></textarea>
      </div>

      <div class="question">
        <label class="question-label" for="sensefils-q2">
          2. FM vs AM
          <span class="required">*</span>
        </label>
        <textarea id="sensefils-q2" data-section="sense_fils" data-question="q2_fm_vs_am" data-required="true"
          placeholder="Explica la difer√®ncia entre modulaci√≥ FM i AM, avantatges i inconvenients de cadascuna."></textarea>
      </div>

      <div class="question">
        <label class="question-label" for="sensefils-q3">
          3. Dispositius amb infrarojos
          <span class="required">*</span>
        </label>
        <textarea id="sensefils-q3" data-section="sense_fils" data-question="q3_dispositius_ir" data-required="true"
          placeholder="Llista almenys 3 dispositius que utilitzen o han utilitzat infrarojos (mando TV, ports IR de m√≤bil antic, etc.)."></textarea>
      </div>

      <div class="question">
        <label class="question-label" for="sensefils-q4">
          4. IR direccionals vs omnidireccionals
          <span class="required">*</span>
        </label>
        <textarea id="sensefils-q4" data-section="sense_fils" data-question="q4_ir_direccional_omni" data-required="true"
          placeholder="Explica la difer√®ncia entre transmissions per infrarojos direccionals i omnidireccionals, amb exemples."></textarea>
      </div>

      <div class="question">
        <label class="question-label" for="sensefils-q5">
          5. Entrevista sobre wifi a les escoles
          <span class="required">*</span>
        </label>
        <textarea id="sensefils-q5" data-section="sense_fils" data-question="q5_entrevista_wifi" data-required="true"
          placeholder="Resumeix qui √©s l'entrevistat, qu√® opina de la wifi a les escoles i quines solucions proposa."></textarea>
      </div>

      <div class="question">
        <label class="question-label" for="sensefils-q6">
          6. Contaminaci√≥ electromagn√®tica
          <span class="required">*</span>
        </label>
        <textarea id="sensefils-q6" data-section="sense_fils" data-question="q6_contaminacio_em" data-required="true"
          placeholder="Defineix qu√® √©s la contaminaci√≥ electromagn√®tica i quins possibles efectes t√© sobre les persones segons les fonts que hagis consultat."></textarea>
      </div>

      <div class="question">
        <label class="question-label" for="sensefils-q7">
          7. GPS i sat√®l¬∑lits
          <span class="required">*</span>
        </label>
        <textarea id="sensefils-q7" data-section="sense_fils" data-question="q7_gps_satel_lits" data-required="true"
          placeholder="Indica aproximadament quants sat√®l¬∑lits calen per al GPS i a quina dist√†ncia es troben de la Terra."></textarea>
      </div>

      <div class="question">
        <label class="question-label" for="sensefils-q8">
          8. Projecte Galileo
          <span class="required">*</span>
        </label>
        <textarea id="sensefils-q8" data-section="sense_fils" data-question="q8_galileo" data-required="true"
          placeholder="Explica en qu√® consisteix Galileo i en qu√® es diferencia del GPS (propietat, cobertura, objectius...)."></textarea>
      </div>

      <div class="question">
        <label class="question-label" for="sensefils-q9">
          9. Generacions m√≤bils (2G‚Äì5G)
          <span class="required">*</span>
        </label>
        <textarea id="sensefils-q9" data-section="sense_fils" data-question="q9_generacions_mobils" data-required="true"
          placeholder="Completa una taula textual amb 2G, 2.5G, 2.75G, 3G, 3.5G, 3.75G, 4G, 5G: tecnologia, velocitat aproximada i usos t√≠pics."></textarea>
      </div>

      <div class="question">
        <label class="question-label" for="sensefils-q10">
          10. 5G a l'Estat espanyol
          <span class="required">*</span>
        </label>
        <textarea id="sensefils-q10" data-section="sense_fils" data-question="q10_5g_operadors" data-required="true"
          placeholder="Indica alguns operadors que ofereixin 5G, amb exemples de tarifes (preu, dades, condicions)."></textarea>
      </div>

      <div class="question">
        <label class="question-label" for="sensefils-q11">
          11. Avantatges del 5G respecte el 4G
          <span class="required">*</span>
        </label>
        <textarea id="sensefils-q11" data-section="sense_fils" data-question="q11_5g_vs_4g" data-required="true"
          placeholder="Explica quins avantatges t√© el 5G respecte el 4G (lat√®ncia, velocitat, IoT, etc.)."></textarea>
      </div>
    </section>

    <!-- APARTAT 4: Cablejat estructurat (A9) -->
    <section id="cablejat-estructurat">
      <div class="section-header">
        <h2>4. Cablejat estructurat (Activitat 9)</h2>
        <span class="section-tag">Subsistemes, racks, proves de cablejat‚Ä¶</span>
      </div>

      <div class="question">
        <label class="question-label" for="ce-q1">
          1. Definici√≥ de cablejat estructurat
          <span class="required">*</span>
        </label>
        <textarea id="ce-q1" data-section="cablejat_estructurat" data-question="q1_definicio" data-required="true"
          placeholder="Defineix qu√® √©s el cablejat estructurat i per qu√® s'utilitza en edificis i oficines."></textarea>
      </div>

      <div class="question">
        <label class="question-label" for="ce-q2">
          2. Caracter√≠stiques (modular, ampliable, flexible, econ√≤mic)
          <span class="required">*</span>
        </label>
        <textarea id="ce-q2" data-section="cablejat_estructurat" data-question="q2_caracteristiques" data-required="true"
          placeholder="Per a cada caracter√≠stica (modular, ampliable, flexible, barat) explica qu√® vol dir en el context del cablejat estructurat."></textarea>
      </div>

      <div class="question">
        <label class="question-label" for="ce-q3">
          3. Avantatges en el disseny de la xarxa
          <span class="required">*</span>
        </label>
        <textarea id="ce-q3" data-section="cablejat_estructurat" data-question="q3_avantatges_disseny" data-required="true"
          placeholder="Explica per qu√® √©s important tenir en compte el cablejat estructurat a l'hora de dissenyar una xarxa i quins avantatges aporta."></textarea>
      </div>

      <div class="question">
        <label class="question-label" for="ce-q4">
          4. Subsistema horitzontal vs vertical (backbone)
          <span class="required">*</span>
        </label>
        <textarea id="ce-q4" data-section="cablejat_estructurat" data-question="q4_horitzontal_vs_vertical" data-required="true"
          placeholder="Descriu les difer√®ncies entre cablejat horitzontal i vertical, i indica en qu√® consisteix principalment cada un."></textarea>
      </div>

      <div class="question">
        <label class="question-label" for="ce-q5">
          5. Sostres i terres t√®cnics
          <span class="required">*</span>
        </label>
        <textarea id="ce-q5" data-section="cablejat_estructurat" data-question="q5_sostres_terres_tecnics" data-required="true"
          placeholder="Explica qu√® s√≥n sostres i terres t√®cnics i com ajuden en la instal¬∑laci√≥ i manteniment del cablejat."></textarea>
      </div>

      <div class="question">
        <label class="question-label" for="ce-q6">
          6. Contingut d'un armari de connexions (rack)
          <span class="required">*</span>
        </label>
        <textarea id="ce-q6" data-section="cablejat_estructurat" data-question="q6_armari_connexions" data-required="true"
          placeholder="Llista alguns dispositius t√≠pics que podem trobar en un rack (patch panels, switches, routers, SAI...)."></textarea>
      </div>

      <div class="question">
        <label class="question-label" for="ce-q7">
          7. Proves de verificaci√≥ del cablejat
          <span class="required">*</span>
        </label>
        <textarea id="ce-q7" data-section="cablejat_estructurat" data-question="q7_proves_verificacio" data-required="true"
          placeholder="Descriu les proves que cal fer despr√©s d'instal¬∑lar la xarxa (continu√Øtat, certificaci√≥, etiquetatge...)."></textarea>
      </div>

      <div class="question">
        <label class="question-label" for="ce-q8">
          8. Aparells per comprovar el cablejat
          <span class="required">*</span>
        </label>
        <textarea id="ce-q8" data-section="cablejat_estructurat" data-question="q8_aparells_comprovacio" data-required="true"
          placeholder="Cerca alguns testers i certificadors de cablejat i explica nom, marca/model i per a qu√® serveixen."></textarea>
      </div>

      <div class="question">
        <label class="question-label" for="ce-q9">
          9. SAI (sistema d'alimentaci√≥ ininterrompuda)
          <span class="required">*</span>
        </label>
        <textarea id="ce-q9" data-section="cablejat_estructurat" data-question="q9_sai" data-required="true"
          placeholder="Explica qu√® √©s un SAI, per a qu√® serveix i per qu√® √©s important en una sala de comunicacions."></textarea>
      </div>
    </section>

    <!-- APARTAT 5: Xarxes de comunicacions i tecnologies d'acc√©s (A10) -->
    <section id="xarxes-comunicacions">
      <div class="section-header">
        <h2>5. Xarxes de comunicacions i tecnologies d'acc√©s (Activitat 10)</h2>
        <span class="section-tag">Impacte social, FTTH, ADSL, altres tecnologies‚Ä¶</span>
      </div>

      <div class="question">
        <label class="question-label" for="xc-q1">
          1. Impacte en l'√†mbit dom√®stic i personal
          <span class="required">*</span>
        </label>
        <textarea id="xc-q1" data-section="xarxes_comunicacions" data-question="q1_impacte_domestic" data-required="true"
          placeholder="Indica 5 aspectes concrets en qu√® les xarxes i Internet han canviat la vida personal/familiar. Per a cada un, indica si ho veus positiu o negatiu i per qu√®."></textarea>
      </div>

      <div class="question">
        <label class="question-label" for="xc-q2">
          2. Impacte en les empreses
          <span class="required">*</span>
        </label>
        <textarea id="xc-q2" data-section="xarxes_comunicacions" data-question="q2_impacte_empreses" data-required="true"
          placeholder="Indica 5 aspectes en qu√® les xarxes han canviat la forma de treballar de les empreses (teletreball, comer√ß electr√≤nic, etc.) i valora si el canvi √©s positiu o negatiu."></textarea>
      </div>

      <div class="question">
        <label class="question-label" for="xc-q3">
          3. Bretxa digital i analfabetisme digital
          <span class="required">*</span>
        </label>
        <textarea id="xc-q3" data-section="xarxes_comunicacions" data-question="q3_bretxa_analfabetisme" data-required="true"
          placeholder="Defineix qu√® √©s la bretxa digital i explica si t√© relaci√≥ amb l'analfabetisme digital. Posa exemples."></textarea>
      </div>

      <div class="question">
        <label class="question-label" for="xc-q4">
          4. Tecnologies d'acc√©s (FTTH, ADSL, HDSL, SDSL, VDSL‚Ä¶)
          <span class="required">*</span>
        </label>
        <textarea id="xc-q4" data-section="xarxes_comunicacions" data-question="q4_taula_tecnologies" data-required="true"
          placeholder="Fes una taula textual comparativa de FTTH, ADSL, HDSL, SDSL, VDSL: medi f√≠sic, velocitat, sim√®trica/asim√®trica, avantatges i inconvenients. Explica per qu√® FTTH √©s la m√©s usada actualment."></textarea>
      </div>

      <div class="question">
        <label class="question-label" for="xc-q5">
          5. Operadors FTTH
          <span class="required">*</span>
        </label>
        <textarea id="xc-q5" data-section="xarxes_comunicacions" data-question="q5_operadors_ftth" data-required="true"
          placeholder="Llista almenys 4 companyies que ofereixen FTTH i fes una taula textual amb tarifes (preu, velocitat, perman√®ncia...). Indica quin operador √©s m√©s econ√≤mic, quin et sembla m√©s fiable i quin √©s m√©s car."></textarea>
      </div>

      <div class="question">
        <label class="question-label" for="xc-q6">
          6. Operadors ADSL
          <span class="required">*</span>
        </label>
        <textarea id="xc-q6" data-section="xarxes_comunicacions" data-question="q6_operadors_adsl" data-required="true"
          placeholder="Indica si encara hi ha ofertes ADSL. Si n'hi ha, fes una taula similar a la de FTTH. Si no, explica per qu√® ha desaparegut i/o exemples hist√≤rics."></textarea>
      </div>

      <div class="question">
        <label class="question-label" for="xc-q7">
          7. Altres tecnologies d'acc√©s a casa
          <span class="required">*</span>
        </label>
        <textarea id="xc-q7" data-section="xarxes_comunicacions" data-question="q7_altres_tecnologies" data-required="true"
          placeholder="Descriu altres tecnologies per fer arribar Internet a les llars (4G/5G FWA, sat√®l¬∑lit, cable HFC, radioenlla√ß...). Compara algunes ofertes de companyies."></textarea>
      </div>
    </section>

    <!-- APARTAT 6: Projecte Taara (A11) -->
    <section id="taara">
      <div class="section-header">
        <h2>6. Projecte Taara i reflexi√≥ (Activitat 11)</h2>
        <span class="section-tag">Enlla√ßos √≤ptics, cobertura global, impacte social‚Ä¶</span>
      </div>

      <div class="question">
        <label class="question-label" for="taara-q1">
          1. Qu√® √©s el projecte Taara?
          <span class="required">*</span>
        </label>
        <textarea id="taara-q1" data-section="taara" data-question="q1_que_es" data-required="true"
          placeholder="Explica en qu√® consisteix el projecte Taara i qui el lidera (empresa / grup)."></textarea>
      </div>

      <div class="question">
        <label class="question-label" for="taara-q2">
          2. Esquema de funcionament
          <span class="required">*</span>
        </label>
        <textarea id="taara-q2" data-section="taara" data-question="q2_esquema_text" data-required="true"
          placeholder="Descriu textualment com funciona el sistema (punts d'enlla√ß, feix de llum, receptors...)."></textarea>

        <div class="info-note">
          A sota pots enganxar un esquema o dibuix del funcionament (captura d'alguna imatge o dibuix propi).
        </div>
        <div class="paste-area"
             data-section="taara"
             data-question="q2_esquema_imatge"
             data-required="true">
          Clica i fes <strong>Ctrl+V</strong> per enganxar l'esquema del sistema Taara.
        </div>
      </div>

      <div class="question">
        <label class="question-label" for="taara-q3">
          3. Primeres proves i tecnologia
          <span class="required">*</span>
        </label>
        <textarea id="taara-q3" data-section="taara" data-question="q3_proves_tecnologia" data-required="true"
          placeholder="Indica on s'han fet les primeres proves i quina tecnologia hi ha al darrere (tipus d'enlla√ß, medi, principi f√≠sic)."></textarea>
      </div>

      <div class="question">
        <label class="question-label" for="taara-q4">
          4. Tipus de connexi√≥ i capacitat
          <span class="required">*</span>
        </label>
        <textarea id="taara-q4" data-section="taara" data-question="q4_connexio_capacitat" data-required="true"
          placeholder="Indica quin tipus de connexi√≥ ofereix (per a qu√® serveix) i la capacitat aproximada de transmissi√≥ de dades."></textarea>
      </div>

      <div class="question">
        <label class="question-label" for="taara-q5">
          5. Avantatges respecte la fibra √≤ptica
          <span class="required">*</span>
        </label>
        <textarea id="taara-q5" data-section="taara" data-question="q5_avantatges_vs_fibra" data-required="true"
          placeholder="Llista els avantatges que ofereix aquest sistema respecte la fibra √≤ptica (costs, desplegament, zones rurals...)."></textarea>
      </div>

      <div class="question">
        <label class="question-label" for="taara-q6">
          6. Qu√® es sacrifica amb aquest projecte?
          <span class="required">*</span>
        </label>
        <textarea id="taara-q6" data-section="taara" data-question="q6_que_sacrifica" data-required="true"
          placeholder="Indica quins aspectes es poden veure sacrificats (fiabilitat, disponibilitat amb mal temps, lat√®ncia, etc.)."></textarea>
      </div>

      <div class="question">
        <label class="question-label" for="taara-q7">
          7. Reflexi√≥ personal
          <span class="required">*</span>
        </label>
        <textarea id="taara-q7" data-section="taara" data-question="q7_reflexio" data-required="true"
          placeholder="Respon breument:
- Avantatges i desavantatges d'una bona cobertura mundial a Internet.
- √âs millor millorar xarxes als pa√Øsos desenvolupats o crear-ne de noves a pa√Øsos amb pocs recursos?
- Quin impacte podria tenir Taara sobre les ISP tradicionals?"></textarea>
      </div>

      <div class="question">
        <label class="question-label" for="taara-q8">
          8. Cerca addicional
          <span class="required">*</span>
        </label>
        <textarea id="taara-q8" data-section="taara" data-question="q8_cerca_addicional" data-required="true"
          placeholder="Cerca informaci√≥ actualitzada sobre Taara i resumeix una dada o projecte pilot que no surti als materials inicials."></textarea>
      </div>
    </section>

    <!-- BOTONS FINALS -->
    <section id="final">
      <div class="section-header">
        <h2>7. Enviament</h2>
        <span class="section-tag">Generar i pujar el fitxer JSON</span>
      </div>

      <p class="info-note">
        Quan hagis respost <strong>totes</strong> les preguntes i afegit les captures necess√†ries,
        prem el bot√≥ <strong>Descarrega JSON</strong>. Es crear√† un fitxer amb totes les teves respostes.
        Despr√©s l'haur√†s de pujar al campus virtual.
      </p>

      <div class="btn-row">
        <span id="status-message" class="status-message"></span>
        <button type="button" class="btn-secondary" id="btn-recalcula">
          Recalcula progr√©s
        </button>
        <button type="button" class="btn-primary" id="btn-descarrega">
          üíæ Descarrega JSON
        </button>
      </div>
    </section>
  </main>

  <script>
    // Variables globals per dades d'alumnes
    let alumnesData = null;
    let metaData = null;

    async function carregaAlumnes() {
      try {
        const res = await fetch("./alumnes/dades_alumnes.json");
        if (!res.ok) {
          throw new Error("No s'ha pogut carregar dades_alumnes.json");
        }
        const data = await res.json();

        // Accepta tant:
        //   "alumnes": [ { ... }, { ... } ]
        // com:
        //   "alumnes": [ [ { ... }, { ... } ] ]
        let alumnesBrut = data.alumnes || [];
        if (Array.isArray(alumnesBrut[0])) {
          alumnesBrut = alumnesBrut[0];
        }
        alumnesData = alumnesBrut;
        metaData = data.meta || {};

        const select = document.getElementById("alumne-select");
        alumnesData.forEach((alumne, idx) => {
          const opt = document.createElement("option");
          opt.value = idx;
          const firstname = alumne.firstname || "";
          const lastname = alumne.lastname || "";
          opt.textContent = (firstname + " " + lastname).trim() || "Alumne " + (idx + 1);
          select.appendChild(opt);
        });
      } catch (err) {
        console.error(err);
        const msg = document.getElementById("status-message");
        msg.textContent = "No s'ha pogut carregar dades_alumnes.json. Revisa la ubicaci√≥ del fitxer.";
        msg.classList.remove("ok");
      }
    }

    function actualitzaEmailAlumne() {
      const select = document.getElementById("alumne-select");
      const emailInput = document.getElementById("alumne-email");
      const idx = select.value;
      if (idx !== "" && alumnesData && alumnesData[idx]) {
        emailInput.value = alumnesData[idx].email || "";
      } else {
        emailInput.value = "";
      }
    }

    function getRequiredFields() {
      return Array.from(document.querySelectorAll("[data-required='true']"));
    }

    function isFieldFilled(el) {
      if (el.classList.contains("paste-area")) {
        return !!el.dataset.imageData;
      }
      const tag = el.tagName.toLowerCase();
      if (tag === "textarea" || tag === "input") {
        return el.value.trim() !== "";
      }
      if (tag === "select") {
        return el.value !== "";
      }
      return false;
    }

    function updateProgress() {
      const fields = getRequiredFields();
      const total = fields.length;
      let filled = 0;
      fields.forEach((el) => {
        if (isFieldFilled(el)) filled++;
      });

      const percent = total > 0 ? Math.round((filled / total) * 100) : 0;
      const bar = document.getElementById("progress-bar");
      const text = document.getElementById("progress-text");

      bar.style.width = percent + "%";
      text.textContent = `Progr√©s: ${percent}% (${filled} de ${total} camps omplerts)`;
    }

    function setupListeners() {
      // Inputs i textareas
      const inputs = document.querySelectorAll("textarea, input[type='text'], select");
      inputs.forEach((el) => {
        el.addEventListener("input", updateProgress);
        el.addEventListener("change", updateProgress);
      });

      // Selector alumne -> actualitza email
      const selectAlumne = document.getElementById("alumne-select");
      selectAlumne.addEventListener("change", () => {
        actualitzaEmailAlumne();
        updateProgress();
      });

      // Zones d'enganxar imatges
      const pasteAreas = document.querySelectorAll(".paste-area");
      pasteAreas.forEach((area) => {
        area.addEventListener("click", () => {
          // per facilitar que el focus vagi aqu√≠
        });

        area.addEventListener("paste", (e) => {
          const items = e.clipboardData && e.clipboardData.items;
          if (!items) return;

          let trobat = false;
          for (let i = 0; i < items.length; i++) {
            const item = items[i];
            if (item.type && item.type.indexOf("image") !== -1) {
              const file = item.getAsFile();
              const reader = new FileReader();
              reader.onload = (ev) => {
                const dataUrl = ev.target.result;
                area.innerHTML = "";
                const img = document.createElement("img");
                img.src = dataUrl;
                area.appendChild(img);
                area.classList.add("has-image");
                area.dataset.imageData = dataUrl;
                updateProgress();
              };
              reader.readAsDataURL(file);
              trobat = true;
              e.preventDefault();
              break;
            }
          }
        });
      });

      document.getElementById("btn-recalcula").addEventListener("click", () => {
        updateProgress();
      });

      document.getElementById("btn-descarrega").addEventListener("click", () => {
        descarregaJSON();
      });
    }

    function recullRespostes() {
      const respostes = {
        cablejat: {},
        fibra: {},
        sense_fils: {},
        cablejat_estructurat: {},
        xarxes_comunicacions: {},
        taara: {}
      };

      // Camps de text / select
      const camps = document.querySelectorAll("[data-section][data-question]");
      camps.forEach((el) => {
        const seccio = el.dataset.section;
        const pregunta = el.dataset.question;
        const tag = el.tagName.toLowerCase();

        let valor = null;
        if (tag === "textarea" || tag === "input" || tag === "select") {
          valor = el.value.trim();
        }

        if (el.classList.contains("paste-area")) {
          valor = el.dataset.imageData || null;
        }

        if (!respostes[seccio]) {
          respostes[seccio] = {};
        }
        respostes[seccio][pregunta] = valor;
      });

      return respostes;
    }

    function validaFormulari() {
      const missing = [];
      const fields = getRequiredFields();

      fields.forEach((el) => {
        if (!isFieldFilled(el)) {
          // busca el label m√©s proper
          let q = el.closest(".question");
          let labelText = "";
          if (q) {
            const lbl = q.querySelector(".question-label");
            if (lbl) labelText = lbl.textContent.trim();
          }
          if (!labelText) {
            labelText = el.id || el.name || "(camp sense nom)";
          }
          missing.push(labelText);
        }
      });

      // Comprova que hi ha alumne seleccionat
      const selectAlumne = document.getElementById("alumne-select");
      if (!selectAlumne.value) {
        missing.push("Alumne (tria el teu nom)");
      }

      const grup = document.getElementById("alumne-grup");
      if (!grup.value.trim()) {
        missing.push("Grup / classe");
      }

      return missing;
    }

    function slugify(str) {
      return str
        .normalize("NFD")
        .replace(/[\u0300-\u036f]/g, "")
        .replace(/[^a-zA-Z0-9]+/g, "_")
        .replace(/^_+|_+$/g, "")
        .toLowerCase();
    }

    function descarregaJSON() {
      const msg = document.getElementById("status-message");
      msg.textContent = "";
      msg.classList.remove("ok");

      const missing = validaFormulari();
      if (missing.length > 0) {
        msg.textContent =
          "Falten camps per omplir. Revisa, si us plau:\n- " +
          missing.join("\n- ");
        msg.classList.remove("ok");
        window.alert(
          "Encara falten camps per omplir. Revisa aquests punts:\n\n- " +
            missing.join("\n- ")
        );
        return;
      }

      const selectAlumne = document.getElementById("alumne-select");
      const idx = selectAlumne.value;
      const grup = document.getElementById("alumne-grup").value.trim();
      const email = document.getElementById("alumne-email").value.trim();

      let alumneObj = null;
      if (alumnesData && alumnesData[idx]) {
        alumneObj = alumnesData[idx];
      }

      const nomComplet = selectAlumne.options[selectAlumne.selectedIndex].textContent.trim();

      const jsonFinal = {
        meta: {
          curs: metaData && metaData.curs ? metaData.curs : null,
          promocio: metaData && metaData.promocio ? metaData.promocio : null,
          centre: metaData && metaData.centre ? metaData.centre : null,
          generat_el: new Date().toISOString()
        },
        alumne: {
          nom_complet: nomComplet,
          email: email || (alumneObj ? alumneObj.email : null),
          grup: grup,
          raw: alumneObj || null
        },
        respostes: recullRespostes()
      };

      const blob = new Blob([JSON.stringify(jsonFinal, null, 2)], {
        type: "application/json"
      });

      const nomArxiu =
        "ra2_xarxes_locals_" +
        (nomComplet ? slugify(nomComplet) : "sense_nom") +
        ".json";

      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = nomArxiu;
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);

      msg.textContent =
        "Fitxer JSON generat correctament: " + nomArxiu + ". Ara el pots pujar al campus virtual.";
      msg.classList.add("ok");
    }

    window.addEventListener("DOMContentLoaded", () => {
      carregaAlumnes();
      setupListeners();
      updateProgress();
    });
  </script>
</body>
</html>
